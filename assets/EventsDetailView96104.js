import{A as _e}from"./AudienceCard96104.js";import{u as oe,U as ve}from"./UploadImageCard96104.js";import{E as fe}from"./EventContentCard96104.js";import{j as ae,s as H,h as U,a as N,e as j,k as pe,d as he,f as ge,i as be,l as le,g as ye,b as xe,c as ke}from"./helpers96104.js";import{e as W,u as Ce,r as Fe}from"./usetoast.esm96104.js";import{r,_ as X,a as h,i as ne,o as a,g as Z,q as A,e as t,t as T,f,b as n,F as I,x as P,h as g,w as L,y as Ve,k as Ue,c as J,n as we,j as R}from"./_plugin-vue_export-helper96104.js";import{u as Ee}from"./events96104.js";import{u as Ie}from"./country96104.js";import{f as K,a as Q}from"./formatData96104.js";import{v as q}from"./runtime-dom.esm-bundler96104.js";import"./group96104.js";import"./user96104.js";import"./datetime96104.js";const Se={props:{title:String,videoUrl:Boolean},setup(D,o){const s=r(),e=oe(),F=W(),b=r(),x=r(),k=r(),C=m=>{b.value=m.files,s.value||(s.value=[])},y=(m,p)=>{m&&(H(),e.deleteAttachment(m).then(()=>{U(),N(F,{message:"File deleted correctly.",title:""}),l(p)}).catch(V=>{U(),j(F,V)}))},l=m=>{s.value.splice(m,1),s.value.length==0&&(s.value=null),x.value.files=[]},c=m=>{b.value.splice(m,1)},_=()=>s.value&&s.value.length>0?10-s.value.length:10;return o.expose({tmp_gallery:s,files:b,fileUpload:x,folder_url:k}),{tmp_gallery:s,files:b,fileUpload:x,folder_url:k,onSelectedFiles:C,deleteImage:y,formatSize:ae,deleteGalleryImage:l,deleteFile:c,checkFileLimit:_}}},Te={class:"flex align-items-center justify-content-between"},Ae={class:"mb-4"},De={class:"flex col-10"},Le={class:"col-6 flex-column p-0"},Be={key:0},Ne=t("h4",{class:"mb-1 mt-0"},"Pending",-1),je={class:"flex flex-wrap"},ze={class:"flex align-items-center"},Ge=["alt","src"],Me={class:"flex flex-column ml-2",style:{"font-size":"12px"}},Oe={class:"mb-1"},Re={key:0,class:"mb-1 mt-3"},qe={class:"flex flex-wrap align-items-center"},He={key:0,class:"flex align-items-top image mx-2 my-2"},Pe=["src"],Ye=["onClick"],Je={key:0,class:"text-center"},Ke=t("b",null,"Drag and drop files to here to upload.",-1),Qe=t("p",{class:"text-xs"},"(You can upload a maximum of 10 images)",-1),We=[Ke,Qe],Xe={class:"ml-4 col-5"},Ze={class:"field"},$e=t("label",{for:"folder_url"},"Folder Url",-1);function et(D,o,s,e,F,b){const x=h("Button"),k=h("FileUpload"),C=h("InputText"),y=h("Card"),l=ne("tooltip");return a(),Z(y,{class:"mt-4"},{content:A(()=>[t("div",Te,[t("h2",Ae,T(s.title),1)]),t("div",De,[t("div",Le,[f(k,{name:"file",url:"https://www.primefaces.org/upload.php",multiple:!0,accept:"image/*",maxFileSize:2e6,id:"logo",modelValue:e.tmp_gallery,"onUpdate:modelValue":o[0]||(o[0]=c=>e.tmp_gallery=c),customUpload:!0,onSelect:e.onSelectedFiles,fileLimit:e.checkFileLimit(),ref:"fileUpload",disabled:e.tmp_gallery&&e.tmp_gallery.length>=10},{content:A(()=>[e.files&&e.files.length>0?(a(),n("div",Be,[Ne,t("div",je,[(a(!0),n(I,null,P(e.files,(c,_)=>(a(),n("div",{key:c.name+c.type+c.size,class:"card m-0 flex border-1 surface-border align-items-center justify-content-between pl-4 pr-3 py-3 w-full my-2"},[t("div",ze,[t("img",{role:"presentation",alt:c.name,src:c.objectURL,width:"50",class:"shadow-2"},null,8,Ge),t("div",Me,[t("div",Oe,T(c.name),1),t("div",null,T(e.formatSize(c.size)),1)])]),f(x,{icon:"pi pi-times",onClick:m=>e.deleteFile(_),class:"p-button p-component p-button-icon-only p-fileupload-file-remove p-button-text p-button-danger p-button-rounded"},null,8,["onClick"])]))),128))])])):g("",!0),e.tmp_gallery&&e.tmp_gallery[0]&&e.tmp_gallery[0].id?(a(),n(I,{key:1},[e.files&&e.files.length>0?(a(),n("h4",Re," Completed ")):g("",!0),t("div",qe,[(a(!0),n(I,null,P(e.tmp_gallery,(c,_)=>(a(),n(I,{key:c.id},[c&&c.url?(a(),n("div",He,[t("img",{role:"presentation",class:"p-fileupload-file-thumbnail h-4rem w-7rem",src:c.url,style:{border:"1px solid rgb(0 0 0 / 6%)"}},null,8,Pe),L(t("i",{class:"pi pi-times p-button-icon text-red-600 cursor-pointer font-semibold icon-delete small",onClick:m=>e.deleteImage(c.id,_)},null,8,Ye),[[l,"Delete",void 0,{top:!0}]])])):g("",!0)],64))),128))])],64)):g("",!0)]),empty:A(()=>[e.tmp_gallery?g("",!0):(a(),n("div",Je,We))]),_:1},8,["modelValue","onSelect","fileLimit","disabled"])]),t("div",Xe,[t("div",Ze,[$e,f(C,{type:"text",modelValue:e.folder_url,"onUpdate:modelValue":o[1]||(o[1]=c=>e.folder_url=c),class:"w-full"},null,8,["modelValue"])])])])]),_:1})}const tt=X(Se,[["render",et]]),lt={props:{title:String,videoUrl:Boolean},setup(D,o){const s=r(),e=oe(),F=W(),b=r(),x=r(),k=r(),C=p=>{b.value=p.files,s.value||(s.value=[])},y=(p,V)=>{p&&(H(),e.deleteAttachment(p).then(()=>{U(),N(F,{message:"File deleted correctly.",title:""}),l(V)}).catch(B=>{U(),j(F,B)}))},l=p=>{s.value.splice(p,1),s.value.length==0&&(s.value=null)},c=p=>{b.value.splice(p,1)},_=()=>s.value&&s.value.length>0?10-s.value.length:10,m=p=>p.type==="image/jpeg";return o.expose({tmp_attachment:s,files:b,fileUpload:x,folder_url:k}),{tmp_attachment:s,files:b,fileUpload:x,folder_url:k,onSelectedFiles:C,deleteImage:y,formatSize:ae,deleteGalleryImage:l,deleteFile:c,checkFileLimit:_,checkIsImage:m,getFileName:pe}}};const ot={class:"flex align-items-center justify-content-between"},at={class:"mb-4"},nt={class:"flex col-10"},st={class:"col-6 flex-column p-0"},it={key:0},ct=t("h4",{class:"mb-1 mt-0"},"Pending",-1),dt={class:"flex flex-wrap"},rt={class:"flex align-items-center"},mt=["alt","src"],ut={key:1,class:"pi pi-file text-2xl"},_t={class:"flex flex-column ml-2",style:{"font-size":"12px"}},vt={class:"mb-1"},ft={key:0,class:"mb-1 mt-3"},pt={class:"flex flex-column"},ht={key:0,class:"flex align-items-top image mx-2 my-2"},gt=["src"],bt={key:1,class:"file mr-2"},yt=["href"],xt=t("i",{class:"pi pi-file text-2xl mr-2"},null,-1),kt=["onClick"],Ct={key:0,class:"text-center"},Ft=t("b",null,"Drag and drop files to here to upload.",-1),Vt=t("p",{class:"text-xs"},"(Maximum size 2 MB)",-1),Ut=[Ft,Vt];function wt(D,o,s,e,F,b){const x=h("Button"),k=h("FileUpload"),C=h("Card"),y=ne("tooltip");return a(),Z(C,{class:"mt-4"},{content:A(()=>[t("div",ot,[t("h2",at,T(s.title),1)]),t("div",nt,[t("div",st,[f(k,{name:"file",url:"https://www.primefaces.org/upload.php",multiple:!0,maxFileSize:2e6,id:"logo",modelValue:e.tmp_attachment,"onUpdate:modelValue":o[0]||(o[0]=l=>e.tmp_attachment=l),customUpload:!0,onSelect:e.onSelectedFiles,fileLimit:e.checkFileLimit(),ref:"fileUpload",disabled:e.tmp_attachment&&e.tmp_attachment.length>=10},{content:A(()=>[e.files&&e.files.length>0?(a(),n("div",it,[ct,t("div",dt,[(a(!0),n(I,null,P(e.files,(l,c)=>(a(),n("div",{key:l.name+l.type+l.size,class:"card m-0 flex border-1 surface-border align-items-center justify-content-between pl-4 pr-3 py-3 w-full my-2"},[t("div",rt,[e.checkIsImage(l)?(a(),n("img",{key:0,role:"presentation",alt:l.name,src:l.objectURL,width:"50",class:"shadow-2"},null,8,mt)):(a(),n("i",ut)),t("div",_t,[t("div",vt,T(l.name),1),t("div",null,T(e.formatSize(l.size)),1)])]),f(x,{icon:"pi pi-times",onClick:_=>e.deleteFile(c),class:"p-button p-component p-button-icon-only p-fileupload-file-remove p-button-text p-button-danger p-button-rounded"},null,8,["onClick"])]))),128))])])):g("",!0),e.tmp_attachment&&e.tmp_attachment[0]&&e.tmp_attachment[0].id?(a(),n(I,{key:1},[e.files&&e.files.length>0?(a(),n("h4",ft," Completed ")):g("",!0),t("div",pt,[(a(!0),n(I,null,P(e.tmp_attachment,(l,c)=>(a(),n(I,{key:l.id},[l&&l.url?(a(),n("div",ht,[e.checkIsImage(l)?(a(),n("img",{key:0,role:"presentation",class:"p-fileupload-file-thumbnail h-4rem w-7rem",src:l.url,style:{border:"1px solid rgb(0 0 0 / 6%)"}},null,8,gt)):(a(),n("div",bt,[t("a",{href:l.url,target:"_blank",class:"flex align-items-center"},[xt,Ve(T(e.getFileName(l.url)),1)],8,yt)])),L(t("i",{class:"pi pi-times p-button-icon text-red-600 cursor-pointer font-semibold icon-delete small",onClick:_=>e.deleteImage(l.id,c)},null,8,kt),[[y,"Delete",void 0,{top:!0}]])])):g("",!0)],64))),128))])],64)):g("",!0)]),empty:A(()=>[e.tmp_attachment?g("",!0):(a(),n("div",Ct,Ut))]),_:1},8,["modelValue","onSelect","fileLimit","disabled"])])])]),_:1})}const Et=X(lt,[["render",wt]]),It={setup(){const D=r({icon:"pi pi-home",to:"/events"}),o=r(""),s=r([{label:""}]),e=r({}),F=["draft","online","archived"],b=r(""),x=r(!0),k=r(!0),C=r(!0),y=r(),l=r(),c=r(),_=r(),m=r(),p=r(!1),V=r(!1),B=Ce(),z=Ue(),u=W(),G=Ee(),se=Ie(),w=J(()=>G.getCurrentEvent),ie=J(()=>se.allCountries),$=J(()=>B.getSelectedCountry),Y=async function(d){H(),G.fetchEventsDetail(d).then(()=>{U(),ce()}).catch(i=>{U(),j(u,i)})},ce=function(){var d,i;if(e.value=Object.assign({},w.value),e.value.country_id=(d=w.value.country)==null?void 0:d.id,b.value=((i=e.value.country)==null?void 0:i.default_language_code)+"",e.value.date=K(w.value.date+""),e.value.bookable_from=K(w.value.bookable_from+""),e.value.bookable_to=K(w.value.bookable_to+""),he(y,e),ge(l,e),_.value){const v=e.value.gallery_images_url;v&&v.length>0&&(_.value.tmp_gallery=v),_.value.folder_url=e.value.folder_url}if(m.value){const v=e.value.attachment_urls;v&&v.length>0&&(m.value.tmp_attachment=v)}be(w,e)},ee=function(){var M;const d=new FormData,i=Object.assign({},e.value);e.value.date&&(i.date=Q(e.value.date)),e.value.bookable_from&&(i.bookable_from=Q(e.value.bookable_from)),e.value.bookable_to&&(i.bookable_to=Q(e.value.bookable_to));const v=l.value.tmp_image,S=_.value.files;if(v&&v.image&&(i.image=v.image),v&&v.video_url&&(i.video_url=l.value.tmp_image.video_url),S&&S.length>0&&S.length>0&&le(S,"event[gallery_images][]",d),_.value&&(i.folder_url=_.value.folder_url),m.value){const O=m.value.files;O&&O.length>0&&O.length>0&&le(O,"event[attachments][]",d)}return i.country_id=(M=i.country)==null?void 0:M.id,delete i.country,(o.value||i.id)&&ye(w,i),delete i.target_all,delete i.target_clusters,delete i.target_group_ids,xe(d,i,"event"),ke(y,d,"event"),d},de=async function(){const d={id:e.value.id,formData:ee()};G.updateEvents(d).then(()=>{U(),Y(e.value.id+""),N(u,{message:"Event updated correctly.",title:""}),_.value.files=[],_.value.fileUpload.files=[],m.value.files=[],m.value.fileUpload.files=[]}).catch(i=>{U(),j(u,i)})},re=async function(){const d={formData:ee()};G.createEvents(d).then(()=>{U(),Y(w.value.id+""),N(u,{message:"Event created correctly.",title:""}),Fe.push({name:"event-detail",params:{id:w.value.id}})}).catch(i=>{U(),j(u,i)})},me=function(){p.value=!0,ue(),V.value?N(u,{message:"Check that you have completed the required fields.",title:"",error:!0}):(z.params.id!=""||e.value.id?de():re(),p.value=!1,H())},ue=function(){var d,i;e.value.translations&&((i=(d=e.value.country)==null?void 0:d.language_codes)==null||i.forEach(v=>{E(e.value.translations[v].title),E(e.value.translations[v].description),E(e.value.translations[v].short_description)})),E(e.value.status),E(e.value.date),E(e.value.bookable_from),E(e.value.bookable_to)},E=function(d){if(p.value)return d==""||d==null?V.value=!0:V.value=!1,V.value},te=function(){var d,i,v,S;b.value!=((d=e.value.country)==null?void 0:d.default_language_code)&&(b.value=((i=e.value.country)==null?void 0:i.default_language_code)+"",e.value.translations={},(S=(v=e.value.country)==null?void 0:v.language_codes)==null||S.forEach(M=>{e.value.translations[M]={title:null,description:null}}))};return we(async()=>{o.value=z.params.id+"",o.value!=""&&o.value!="undefined"?(Y(o.value),s.value[0]={label:"Edit events"}):(e.value.status="draft",s.value[0]={label:"Add events"},e.value.country=$.value,e.value.country_id=$.value.id,te())}),{home:D,items:s,tmp_events:e,events_status:F,audienceCard:y,selectedLang:b,showCheckboxAll:x,showSelectClusters:k,showSelectGroups:C,submitForm:p,uploadImageCard:l,eventContentCard:c,galleryImageCard:_,uploadAttachmentCard:m,countries:ie,validateField:E,saveEvent:me,setSelectedLang:te}},components:{AudienceCard:_e,UploadImageCard:ve,EventContentCard:fe,GalleryImageCard:tt,UploadAttachmentCard:Et}},St={class:"m-4"},Tt={class:"flex justify-content-between align-items-center mb-3"},At={class:"flex align-items-start justify-content-between"},Dt=t("h2",{class:"mb-2"},"EVENT DETAIL",-1),Lt={key:0,class:"field col-2 mb-0"},Bt={key:0,class:"p-error"},Nt={class:"formgrid grid col-10 px-0 xs:col-12"},jt={key:0,class:"field col-6 xs:col-6 flex flex-column"},zt=t("label",{for:"name"},"Location",-1),Gt={key:0,class:"formgrid grid col-10 px-0 xs:col-12"},Mt={class:"field col-3 xs:col-4"},Ot=t("label",{for:"name"},"Event date*",-1),Rt={key:0,class:"p-error"},qt={class:"field col-3 xs:col-4"},Ht=t("label",{for:"name"},"Bookable from*",-1),Pt={key:0,class:"p-error"},Yt={class:"field col-3 xs:col-4"},Jt=t("label",{for:"name"},"Bookable to*",-1),Kt={key:0,class:"p-error"},Qt={key:1,class:"formgrid grid col-10 px-0 xs:col-12"},Wt={class:"field col-3 flex flex-column"},Xt=t("label",{for:"title"},"Available seats",-1),Zt={class:"field col-3 flex flex-column"},$t=t("label",{for:"title"},"Number guests per person",-1),el={class:"field col-3 mt-4 mb-0"},tl={class:"field-checkbox"},ll=t("label",{for:"gift"},"There is a free gift",-1);function ol(D,o,s,e,F,b){const x=h("Breadcrumb"),k=h("Button"),C=h("Dropdown"),y=h("InputText"),l=h("Calendar"),c=h("Checkbox"),_=h("Card"),m=h("AudienceCard"),p=h("EventContentCard"),V=h("UploadImageCard"),B=h("GalleryImageCard"),z=h("UploadAttachmentCard");return a(),n("div",St,[t("div",Tt,[f(x,{home:e.home,model:e.items,class:"mt-0 p-0"},null,8,["home","model"]),f(k,{label:"Save",onClick:e.saveEvent},null,8,["onClick"])]),f(_,null,{content:A(()=>[t("div",At,[Dt,e.tmp_events.country?(a(),n("div",Lt,[f(C,{modelValue:e.tmp_events.status,"onUpdate:modelValue":o[0]||(o[0]=u=>e.tmp_events.status=u),options:e.events_status,class:R(["w-full capitalize dropdown-status",{"p-invalid":e.validateField(e.tmp_events.status)}])},null,8,["modelValue","options","class"]),e.validateField(e.tmp_events.status)?(a(),n("small",Bt,"Campo obbligatorio.")):g("",!0)])):g("",!0)]),t("div",Nt,[e.tmp_events.country?(a(),n("div",jt,[zt,f(y,{id:"title",type:"text",modelValue:e.tmp_events.location,"onUpdate:modelValue":o[1]||(o[1]=u=>e.tmp_events.location=u)},null,8,["modelValue"])])):g("",!0)]),e.tmp_events.country?(a(),n("div",Gt,[t("div",Mt,[Ot,f(l,{inputId:"dateformat",modelValue:e.tmp_events.date,"onUpdate:modelValue":o[2]||(o[2]=u=>e.tmp_events.date=u),dateFormat:"dd/mm/yy",manualInput:!1,class:R({"p-invalid":e.validateField(e.tmp_events.date)}),placeholder:"gg/mm/aaaa"},null,8,["modelValue","class"]),e.validateField(e.tmp_events.date)?(a(),n("small",Rt,"Campo obbligatorio.")):g("",!0)]),t("div",qt,[Ht,f(l,{inputId:"dateformat",modelValue:e.tmp_events.bookable_from,"onUpdate:modelValue":o[3]||(o[3]=u=>e.tmp_events.bookable_from=u),dateFormat:"dd/mm/yy",manualInput:!1,class:R({"p-invalid":e.validateField(e.tmp_events.bookable_from)}),placeholder:"gg/mm/aaaa"},null,8,["modelValue","class"]),e.validateField(e.tmp_events.bookable_from)?(a(),n("small",Pt,"Campo obbligatorio.")):g("",!0)]),t("div",Yt,[Jt,f(l,{inputId:"dateformat",modelValue:e.tmp_events.bookable_to,"onUpdate:modelValue":o[4]||(o[4]=u=>e.tmp_events.bookable_to=u),dateFormat:"dd/mm/yy",manualInput:!1,class:R({"p-invalid":e.validateField(e.tmp_events.bookable_to)}),placeholder:"gg/mm/aaaa"},null,8,["modelValue","class"]),e.validateField(e.tmp_events.bookable_to)?(a(),n("small",Kt,"Campo obbligatorio.")):g("",!0)])])):g("",!0),e.tmp_events.country?(a(),n("div",Qt,[t("div",Wt,[Xt,f(y,{id:"title",type:"text",modelValue:e.tmp_events.seats,"onUpdate:modelValue":o[5]||(o[5]=u=>e.tmp_events.seats=u)},null,8,["modelValue"])]),t("div",Zt,[$t,f(y,{id:"title",type:"text",modelValue:e.tmp_events.guests,"onUpdate:modelValue":o[6]||(o[6]=u=>e.tmp_events.guests=u)},null,8,["modelValue"])]),t("div",el,[t("div",tl,[f(c,{inputId:"gift",modelValue:e.tmp_events.gift,"onUpdate:modelValue":o[7]||(o[7]=u=>e.tmp_events.gift=u),binary:!0},null,8,["modelValue"]),ll])])])):g("",!0)]),_:1}),L(f(m,{ref:"audienceCard"},null,512),[[q,e.tmp_events.country]]),e.tmp_events.country&&e.selectedLang?(a(),Z(p,{key:0,selectedLang:e.selectedLang,submitForm:e.submitForm,tmp_events:e.tmp_events,ref:"eventContentCard",title:"EVENT CONTENT"},null,8,["selectedLang","submitForm","tmp_events"])):g("",!0),L(f(V,{title:"EVENT MEDIA",videoUrl:!0,ref:"uploadImageCard"},null,512),[[q,e.tmp_events.country]]),L(f(B,{title:"EVENT GALLERY",videoUrl:!1,ref:"galleryImageCard"},null,512),[[q,e.tmp_events.country&&e.tmp_events.id]]),L(f(z,{title:"EVENT ATTACHMENTS",videoUrl:!1,ref:"uploadAttachmentCard"},null,512),[[q,e.tmp_events.country&&e.tmp_events.id]])])}const hl=X(It,[["render",ol]]);export{hl as default};
