import{a as B}from"./api.esm67435.js";import{ab as K,u as $,c as b,ac as O,r as h,a as P,_ as D,b as i,k as E,o as p,e as y,g as t,v as d,B as R,h as C,l as k,w as A,f as S,x as z}from"./usetoast.esm67435.js";import{u as T}from"./user67435.js";import{u as N}from"./country67435.js";import{e as I}from"./helpers67435.js";import{w}from"./runtime-dom.esm-bundler67435.js";const L={setup(){K(()=>{v.value=!0,r.value={first:0,rows:_.value.rows,sortField:null,sortOrder:null,filters:c.value},B.register("myfilter",(o,x)=>o===x),s()});const m=T(),n=N(),g=$(),a=b(()=>m.responseUsers),U=b(()=>n.allCountries),M=b(()=>m.userRoles),f=b(()=>g.getSelectedCountry),u=O(),_=h(),c=h({sellout_code:{value:"",matchMode:"contains"},role:{value:"",matchMode:"contains"},company_name:{value:"",matchMode:"contains"},country:{value:f.value.id,matchMode:"contains"},agent_code:{value:"",matchMode:"contains"},dealer_code:{value:"",matchMode:"contains"}}),v=h(!0),r=h(),F=h(0),V=h([{label:"Enabled",value:"true"},{label:"Disabled",value:"false"}]),e=h([{label:"My Filter",value:"myfilter"}]);function s(){v.value=!0;const o=new Map;o.set("country_id",c.value.country.value),o.set("company_name",c.value.company_name.value),o.set("role",c.value.role.value),o.set("sellout_code",c.value.sellout_code.value),o.set("agent_code",c.value.agent_code.value),o.set("dealer_code",c.value.dealer_code.value),o.set("page",r.value.page+1),o.set("per_page",r.value.rows),r.value.sortField&&(r.value.sortOrder==1?o.set("sorted_by",r.value.sortField+"_asc"):o.set("sorted_by",r.value.sortField+"_desc")),setTimeout(()=>{l(o)},Math.random()*1e3+250)}const l=async function(o){await m.fetchAllUsers(o).then(()=>{v.value=!1}).catch(x=>{v.value=!1,I(u,x)})};return{dt:_,responseUsers:a,filters:c,loading:v,totalRecords:F,lazyParams:r,matchModes:e,countries:U,userRoles:M,status:V,onPage:o=>{r.value=o,s()},onSort:o=>{r.value=o,s()},onFilter:()=>{r.value.page=0,r.value.filters=c.value,s()},toggleEdit:function(o){P.push({name:"user-detail",params:{id:o.id}})}}}};const j={key:0,class:"pi pi-check text-color-secondary"},W={key:1,class:"pi pi-times text-red-600"};function q(m,n,g,a,U,M){const f=i("InputText"),u=i("Column"),_=i("Badge"),c=i("Dropdown"),v=i("Button"),r=i("DataTable"),F=i("ConfirmPopup"),V=E("tooltip");return p(),y("div",null,[t(r,{value:a.responseUsers.users,totalRecords:a.responseUsers.total,lazy:!0,paginator:!0,rows:30,filters:a.filters,"onUpdate:filters":n[0]||(n[0]=e=>a.filters=e),ref:"dt",dataKey:"id",loading:a.loading,onPage:n[1]||(n[1]=e=>a.onPage(e)),onSort:n[2]||(n[2]=e=>a.onSort(e)),onFilter:n[3]||(n[3]=e=>a.onFilter()),filterDisplay:"row",removableSort:""},{empty:d(()=>[R(" No users found. ")]),default:d(()=>[t(u,{field:"sellout_code",header:"Sellout code",filterMatchMode:"contains",ref:"sellout_code",sortable:!0,showFilterMatchModes:!1,showFilterOperator:!1,showFilterMenu:!1},{filter:d(({filterModel:e,filterCallback:s})=>[t(f,{type:"text",modelValue:e.value,"onUpdate:modelValue":l=>e.value=l,onKeydown:w(l=>s(),["enter"]),class:"p-column-filter",placeholder:"Filter by sellout code"},null,8,["modelValue","onUpdate:modelValue","onKeydown"])]),_:1},512),t(u,{field:"company_name",header:"Company",filterMatchMode:"contains",ref:"company_name",sortable:!1,showFilterMatchModes:!1,showFilterOperator:!1,showFilterMenu:!1},{filter:d(({filterModel:e,filterCallback:s})=>[t(f,{type:"text",modelValue:e.value,"onUpdate:modelValue":l=>e.value=l,onKeydown:w(l=>s(),["enter"]),class:"p-column-filter",placeholder:"Filter by company"},null,8,["modelValue","onUpdate:modelValue","onKeydown"])]),_:1},512),t(u,{field:"role",header:"Cluster",filterMatchMode:"contains",ref:"role",sortable:!1,showFilterMatchModes:!1,showFilterOperator:!1,showFilterMenu:!1},{body:d(({data:e})=>[e.role=="dealer"?(p(),C(_,{key:0,value:"Distributor",class:k(["px-4",e.role])},null,8,["class"])):e.role=="user"?(p(),C(_,{key:1,value:"Workshop",class:k(["px-4",e.role])},null,8,["class"])):(p(),C(_,{key:2,value:e.role,class:k(["px-4",e.role])},null,8,["value","class"]))]),filter:d(({filterModel:e,filterCallback:s})=>[t(c,{modelValue:e.value,"onUpdate:modelValue":l=>e.value=l,options:a.userRoles,optionValue:"value",optionLabel:"name",onChange:l=>s(),placeholder:"Filter by cluster"},null,8,["modelValue","onUpdate:modelValue","options","onChange"])]),_:1},512),t(u,{header:"Status",ref:"enabled",field:"enabled",style:{width:"100px"}},{body:d(({data:e})=>[e.enabled?(p(),y("i",j)):(p(),y("i",W))]),_:1},512),t(u,{field:"agent_code",header:"Agent code",filterMatchMode:"contains",ref:"agent_code",sortable:!1,showFilterMatchModes:!1,showFilterOperator:!1,showFilterMenu:!1},{filter:d(({filterModel:e,filterCallback:s})=>[t(f,{type:"text",modelValue:e.value,"onUpdate:modelValue":l=>e.value=l,onKeydown:w(l=>s(),["enter"]),class:"p-column-filter",placeholder:"Filter by code"},null,8,["modelValue","onUpdate:modelValue","onKeydown"])]),_:1},512),t(u,{header:"Agent",field:"agent_name"}),t(u,{field:"dealer_code",header:"Distributor code",filterMatchMode:"contains",ref:"dealer_code",sortable:!1,showFilterMatchModes:!1,showFilterOperator:!1,showFilterMenu:!1},{filter:d(({filterModel:e,filterCallback:s})=>[t(f,{type:"text",modelValue:e.value,"onUpdate:modelValue":l=>e.value=l,onKeydown:w(l=>s(),["enter"]),class:"p-column-filter",placeholder:"Filter by code"},null,8,["modelValue","onUpdate:modelValue","onKeydown"])]),_:1},512),t(u,{header:"Distributor",field:"dealer_name"}),t(u,{header:"",style:{width:"4rem"}},{body:d(({data:e})=>[A(t(v,{type:"button",onClick:s=>a.toggleEdit(e),"aria-haspopup":"true","aria-controls":"overlay_menu",class:"p-button-text p-button-rounded text-300 surface-200 mr-3",icon:"pi pi-pencil"},null,8,["onClick"]),[[V,"Edit",void 0,{top:!0}]])]),_:1})]),_:1},8,["value","totalRecords","filters","loading"]),t(F)])}const G=D(L,[["render",q]]),H={setup(){const m=T();return{totalUser:b(()=>m.getTotalUsers)}},components:{UsersTable:G}},J={class:"flex justify-content-between align-items-center"},Q={class:"uppercase"},X={key:0},Y={key:1};function Z(m,n,g,a,U,M){const f=i("Button"),u=i("UsersTable"),_=i("Card");return p(),y("div",null,[t(_,null,{content:d(()=>[S("div",J,[S("h1",Q,[a.totalUser==1?(p(),y("span",X," 1 User")):(p(),y("span",Y,z(a.totalUser)+" Users",1))]),t(f,{label:"user",onClick:n[0]||(n[0]=c=>m.$router.push("/user-detail")),icon:"pi pi-plus",class:"mb-3"})]),t(u)]),_:1})])}const de=D(H,[["render",Z]]);export{de as default};
