import{u as A,e as B,r as _}from"./usetoast.esm96104.js";import{u as U,r as g,e as M}from"./index.esm96104.js";import{s as N,h as y,e as h}from"./helpers96104.js";import{u as T,L as I}from"./sidebar96104.js";import{u as q}from"./country96104.js";import{u as z}from"./product96104.js";import{d as E,ad as D,r as V,m as F,c as R,_ as W,a as i,o as w,b as $,f as a,q as v,e as t,j as C,t as P,h as L,y as G}from"./_plugin-vue_export-helper96104.js";import{a as H}from"./runtime-dom.esm-bundler96104.js";const J=E({name:"LoginView",setup(){D(()=>{c.setSidebarVisibility(!1)});const e=A(),s=B(),c=T(),b=q(),S=V(1),m=F({email:"",password:"",terms:null}),u={password:{required:g},email:{required:g,email:M}},n=V(!1),p=U(u,m),d=R(()=>e.user),f=z(),o=r=>{n.value=!0,r&&(N(),k().then(()=>{y(),d.value.force_change_password&&_.push({name:"reset-password"}),c.setSidebarVisibility(!0),j(),x(),_.push({name:"users"})}).catch(l=>{y(),h(s,l)}))};async function k(){const r={login:m.email,password:m.password};await e.login(r)}const j=async function(){const r=new Map;await b.fetchAllCountries(r).catch(l=>{h(s,l)})},x=async function(){const r=new Map;await f.fetchAllProducts(r).catch(l=>{h(s,l)})};return{formStep:S,formSubmitted:n,v$:p,currentUser:d,handleSubmit:o}},components:{LogoPetronas:I}}),K={class:"flex justify-content-center align-items-center h-screen"},O={class:"mt-5 text-center"},Q=t("h1",{class:"text-center mb-2"},"Sign In!",-1),X=t("h2",{class:"font-normal mb-4"}," Welcome! Please enter your email and password. ",-1),Y={key:0,class:"p-error w-100"},Z={class:"w-full flex flex-column flex-1"},ee={class:"flex justify-content-between mt-1"},se={key:0,class:"p-error col-5 p-0 m-0"},oe={class:"w-full flex justify-content-end text-sm cursor-pointer text-color-secondary"},te={class:"mt-2 text-right w-full mb-3"};function re(e,s,c,b,S,m){const u=i("LogoPetronas"),n=i("InputText"),p=i("router-link"),d=i("Button"),f=i("Card");return w(),$("div",K,[a(f,{class:"p-4"},{header:v(()=>[t("div",O,[a(u)])]),content:v(()=>[Q,X,t("form",{class:"mt-4 flex flex-column",onSubmit:s[2]||(s[2]=H(o=>e.handleSubmit(!e.v$.$invalid),["prevent"]))},[a(n,{id:"email",class:C({"p-invalid":e.v$.email.$invalid&&e.formSubmitted,"w-100":!0,"mb-1":!0}),placeholder:"Email*",modelValue:e.v$.email.$model,"onUpdate:modelValue":s[0]||(s[0]=o=>e.v$.email.$model=o)},null,8,["class","modelValue"]),e.formSubmitted&&e.v$.email.$errors.length>0?(w(),$("label",Y,P(e.v$.email.$errors.map(o=>o.$message).join("<br />")),1)):L("",!0),t("div",Z,[a(n,{id:"password",class:C({"p-invalid":e.v$.password.$invalid&&e.formSubmitted,"w-100":!0,"mt-3":!0,"mb-1":!0}),type:"password",placeholder:"Password*",modelValue:e.v$.password.$model,"onUpdate:modelValue":s[1]||(s[1]=o=>e.v$.password.$model=o)},null,8,["class","modelValue"]),t("div",ee,[e.formSubmitted&&e.v$.password.$errors.length>0?(w(),$("label",se,P(e.v$.password.$errors.map(o=>o.$message).join("<br />")),1)):L("",!0),t("div",oe,[a(p,{to:"/forgot-password",class:"text-color-secondary"},{default:v(()=>[G("Forgot Password?")]),_:1})])])]),t("div",te,[a(d,{type:"submit",label:"Sign in",class:"w-full mt-4 capitalize"})])],32)]),_:1})])}const pe=W(J,[["render",re]]);export{pe as default};
