import{r as c,p as K,ac as Q,u as W,c as y,n as X,a as Z,_ as $,b as f,o as v,e as h,f as l,g as t,v as V,i as U,l as F,x as b}from"./usetoast.esm40966.js";import{e as x,a as w,s as B,h as m}from"./helpers40966.js";import{u as ee}from"./user40966.js";const le={setup(){const L=c({icon:"pi pi-home",to:"/users"}),s=c(""),C=c([{label:""}]),e=c({}),z=c([{label:"Enabled",value:!0},{label:"Disabled",value:!1}]),N=c(),g=c(!1),k=K(),i=Q(),a=ee(),_=W(),E=c(!1),T=c(!1),o=c(!1),p=c(!1),d=y(()=>a.getCurrentUser),A=y(()=>a.userRoles),u=y(()=>a.allUsers),I=y(()=>_.getUserCountryId),O=y(()=>_.getSelectedCountry),R=async function(n){B(),a.fetchUserDetail(n).then(()=>{m(),P()}).catch(r=>{m(),x(i,r)})},j=async function(n){const r=new Map;n&&r.set("full_name_or_email",n.query),r.set("country_id",I.value),e.value.role=="user"?r.set("role","agent"):e.value.role=="agent"?r.set("role","dealer"):e.value.role=="dealer"&&r.set("role","vendor"),await a.fetchAllUsers(r).catch(S=>{x(i,S)})},M=async function(){var S;e.value.parent&&(e.value.parent_id=e.value.parent.id);const n=Object.assign({},e.value);n.email==""&&((S=d.value.email)!=null&&S.includes("fake"))&&(n.email=d.value.email);const r={user:n};a.updateUser(r).then(()=>{m(),R(d.value.id+""),w(i,{message:"User updated correctly.",title:""})}).catch(J=>{m(),x(i,J)})},q=async function(){const n={user:e.value};a.createUser(n).then(()=>{m(),R(d.value.id+""),w(i,{message:"User created correctly.",title:""}),Z.push({name:"user-detail",params:{id:d.value.id}})}).catch(r=>{m(),x(i,r)})},P=function(){var n;e.value=Object.assign({},d.value),e.value.country_id=(n=d.value.country)==null?void 0:n.id,delete e.value.country,d.value.email&&d.value.email.includes("fake")&&(e.value.email="")},Y=function(){D(e.value.role),D(e.value.sellout_code),D(e.value.company_name)},G=function(){if(g.value=!0,Y(),e.value.parent&&(e.value.parent_id=e.value.parent.id),p.value){w(i,{message:"Check that you have completed the required fields.",title:"",error:!0});return}s.value!=""||e.value.id?M():q(),g.value=!1,B()},D=function(n){if(g.value)return n==""||n==null?p.value=!0:p.value=!1,p.value},H=async function(){a.disableUser(e.value.id+"",e.value.enabled).then(()=>{m(),e.value.enabled?w(i,{message:"User successfully enabled.",title:""}):w(i,{message:"User successfully disabled.",title:""})}).catch(n=>{m(),x(i,n)})};return X(async()=>{j(null),s.value=k.params.id+"",s.value!=""&&s.value!="undefined"?(R(s.value),C.value[0]={label:"Edit user"}):(C.value[0]={label:"New user"},e.value.country_id=O.value.id)}),{home:L,items:C,tmp_user:e,invalid_cluster:E,invalid_original_sellout_code:T,invalid_phone:o,userAdminRoles:A,filteredUsers:N,allUsers:u,user_status:z,saveUser:G,validateField:D,fetchAllUsers:j,disableUser:H}},components:{}};const se={class:"m-4"},oe={class:"flex justify-content-between align-items-center mb-3"},te={class:"flex align-items-center justify-content-between"},ae=l("h2",{class:"mb-2"},"USER DETAILS",-1),ne={key:0,class:"field col-2 mb-0"},ie={class:"formgrid grid col-10 px-0"},de={class:"field col-6"},re=l("label",{for:"cluster"},"Cluster*",-1),ce={key:0,class:"p-error"},ue={class:"field col-6"},me=l("label",{for:"name"},"Full name",-1),_e={class:"field col-6"},pe=l("label",{for:"phone"},"Phone",-1),fe={class:"field col-6"},ve=l("label",{for:"name"},"Email",-1),he={class:"field col-6"},be=l("label",{for:"company"},"Company*",-1),ge={key:0,class:"p-error"},ye={class:"field col-6"},Ve=l("label",{for:"name"},"Vat code",-1),Ue=l("div",{class:"flex align-items-center justify-content-between"},[l("h2",{class:"mb-2"},"SELLOUT DATA")],-1),xe={class:"formgrid grid col-10 px-0"},we={class:"field col-6"},Ce=l("label",{for:"sellout_code"},"Actual sellout code*",-1),Ae={key:0,class:"p-error"},De={class:"field col-6 flex flex-column"},Se=l("label",{for:"original_sellout_code"},"Original sellout code",-1),ke=l("div",{class:"flex align-items-center justify-content-between"},[l("h2",{class:"mb-2"},"DELIVERY ADDRESS")],-1),Ee={class:"formgrid grid col-10 px-0"},Te={class:"field col-6"},Re=l("label",{for:"shipping_name"},"Recipient",-1),Fe=l("div",{class:"col-6"},null,-1),Le={class:"field col-6"},ze=l("label",{for:"shipping_city"},"City",-1),Ne={class:"field col-3"},je=l("label",{for:"shipping_province"},"Province",-1),Be={class:"field col-2"},Ie=l("label",{for:"shipping_zip"},"Cap",-1),Oe={class:"field col-6"},Me=l("label",{for:"shipping_zip"},"Address",-1),qe={class:"field col-3"},Pe=l("label",{for:"shipping_number"},"Number",-1),Ye={class:"field col-12"},Ge=l("label",{for:"shipping_note"},"Note",-1),He=l("div",{class:"flex align-items-center justify-content-between"},[l("h2",{class:"mb-2"},"MORE DATA")],-1),Je={class:"formgrid grid col-10 px-0"},Ke={class:"field col-6 flex flex-column"},Qe=l("label",{for:"original_sellout_code"},"User parent",-1),We=l("div",{class:"col-6"},null,-1),Xe={key:0},Ze=l("div",{class:"flex align-items-center justify-content-between col-12"},[l("h2",{class:"mb-3"},"PARENT DETAIL")],-1),$e={class:"field flex col-12"},el=l("div",{class:"flex flex-column mr-2 line-height-3"},[l("span",{class:"mb-1"},"Sellout code: "),l("span",{class:"mb-1"},"Company:"),l("span",{class:"mb-1"},"Email: "),l("span",{class:"mb-1"},"Role:")],-1),ll={class:"flex flex-column line-height-3"},sl={class:"mb-1"},ol={class:"mb-1"},tl={class:"mb-1"},al={class:"capitalize"};function nl(L,s,C,e,z,N){const g=f("Breadcrumb"),k=f("Button"),i=f("Dropdown"),a=f("InputText"),_=f("Card"),E=f("Textarea"),T=f("AutoComplete");return v(),h("div",se,[l("div",oe,[t(g,{home:e.home,model:e.items,class:"mt-0 p-0"},null,8,["home","model"]),t(k,{label:"Save",onClick:e.saveUser},null,8,["onClick"])]),t(_,null,{content:V(()=>[l("div",te,[ae,e.tmp_user.id?(v(),h("div",ne,[t(i,{modelValue:e.tmp_user.enabled,"onUpdate:modelValue":s[0]||(s[0]=o=>e.tmp_user.enabled=o),options:e.user_status,class:"w-full capitalize dropdown-status",optionLabel:"label",optionValue:"value",onChange:s[1]||(s[1]=o=>e.disableUser())},null,8,["modelValue","options"])])):U("",!0)]),l("div",ie,[l("div",de,[re,t(i,{modelValue:e.tmp_user.role,"onUpdate:modelValue":s[2]||(s[2]=o=>e.tmp_user.role=o),options:e.userAdminRoles,optionLabel:"name",optionValue:"value",id:"cluster",class:F(["w-full",{"p-invalid":e.validateField(e.tmp_user.role)}])},null,8,["modelValue","options","class"]),e.validateField(e.tmp_user.role)?(v(),h("small",ce,"Campo obbligatorio.")):U("",!0)]),l("div",ue,[me,t(a,{id:"name",type:"text",modelValue:e.tmp_user.full_name,"onUpdate:modelValue":s[3]||(s[3]=o=>e.tmp_user.full_name=o),class:"w-full"},null,8,["modelValue"])]),l("div",_e,[pe,t(a,{id:"phone",type:"text",modelValue:e.tmp_user.phone,"onUpdate:modelValue":s[4]||(s[4]=o=>e.tmp_user.phone=o),class:"w-full"},null,8,["modelValue"])]),l("div",fe,[ve,t(a,{id:"name",type:"text",modelValue:e.tmp_user.email,"onUpdate:modelValue":s[5]||(s[5]=o=>e.tmp_user.email=o),class:"w-full"},null,8,["modelValue"])]),l("div",he,[be,t(a,{id:"company_name",type:"text",modelValue:e.tmp_user.company_name,"onUpdate:modelValue":s[6]||(s[6]=o=>e.tmp_user.company_name=o),class:F(["w-full",{"p-invalid":e.validateField(e.tmp_user.company_name)}])},null,8,["modelValue","class"]),e.validateField(e.tmp_user.company_name)?(v(),h("small",ge,"Campo obbligatorio.")):U("",!0)]),l("div",ye,[Ve,t(a,{id:"name",type:"text",modelValue:e.tmp_user.vat_cf,"onUpdate:modelValue":s[7]||(s[7]=o=>e.tmp_user.vat_cf=o),class:"w-full"},null,8,["modelValue"])])])]),_:1}),t(_,{class:"mt-4"},{content:V(()=>[Ue,l("div",xe,[l("div",we,[Ce,t(a,{id:"sellout_code",type:"text",modelValue:e.tmp_user.sellout_code,"onUpdate:modelValue":s[8]||(s[8]=o=>e.tmp_user.sellout_code=o),class:F(["w-full",{"p-invalid":e.validateField(e.tmp_user.original_sellout_code)}])},null,8,["modelValue","class"]),e.validateField(e.tmp_user.sellout_code)?(v(),h("small",Ae,"Campo obbligatorio.")):U("",!0)]),l("div",De,[Se,t(a,{id:"original_sellout_code",type:"text",modelValue:e.tmp_user.original_sellout_code,"onUpdate:modelValue":s[9]||(s[9]=o=>e.tmp_user.original_sellout_code=o)},null,8,["modelValue"])])])]),_:1}),t(_,{class:"mt-4"},{content:V(()=>[ke,l("div",Ee,[l("div",Te,[Re,t(a,{id:"shipping_name",type:"text",modelValue:e.tmp_user.shipping_name,"onUpdate:modelValue":s[10]||(s[10]=o=>e.tmp_user.shipping_name=o),class:"w-full"},null,8,["modelValue"])]),Fe,l("div",Le,[ze,t(a,{id:"shipping_city",type:"text",modelValue:e.tmp_user.shipping_city,"onUpdate:modelValue":s[11]||(s[11]=o=>e.tmp_user.shipping_city=o),class:"w-full"},null,8,["modelValue"])]),l("div",Ne,[je,t(a,{id:"shipping_province",type:"text",modelValue:e.tmp_user.shipping_province,"onUpdate:modelValue":s[12]||(s[12]=o=>e.tmp_user.shipping_province=o),class:"w-full"},null,8,["modelValue"])]),l("div",Be,[Ie,t(a,{id:"shipping_zip",type:"text",modelValue:e.tmp_user.shipping_zip,"onUpdate:modelValue":s[13]||(s[13]=o=>e.tmp_user.shipping_zip=o),class:"w-full"},null,8,["modelValue"])]),l("div",Oe,[Me,t(a,{id:"shipping_zip",type:"text",modelValue:e.tmp_user.shipping_address,"onUpdate:modelValue":s[14]||(s[14]=o=>e.tmp_user.shipping_address=o),class:"w-full"},null,8,["modelValue"])]),l("div",qe,[Pe,t(a,{id:"shipping_number",type:"text",modelValue:e.tmp_user.shipping_number,"onUpdate:modelValue":s[15]||(s[15]=o=>e.tmp_user.shipping_number=o),class:"w-full"},null,8,["modelValue"])]),l("div",Ye,[Ge,t(E,{modelValue:e.tmp_user.shipping_note,"onUpdate:modelValue":s[16]||(s[16]=o=>e.tmp_user.shipping_note=o),rows:"5",cols:"30",class:"w-full"},null,8,["modelValue"])])])]),_:1}),t(_,{class:"mt-4"},{content:V(()=>{var o,p,d,A;return[He,l("div",Je,[l("div",Ke,[Qe,t(T,{modelValue:e.tmp_user.parent,"onUpdate:modelValue":s[17]||(s[17]=u=>e.tmp_user.parent=u),suggestions:e.allUsers,onComplete:s[18]||(s[18]=u=>e.fetchAllUsers(u)),optionLabel:"email",optionValude:"id",emptySearchMessage:"Nessun risultato",emptySelectionMessage:"Nessun risultato",disabled:!e.tmp_user.role,placeholder:"Search by sellout code"},{item:V(u=>[l("div",null,b(u.item.company_name)+" ("+b(u.item.email)+") ",1)]),_:1},8,["modelValue","suggestions","disabled"])]),We,e.tmp_user.parent?(v(),h("div",Xe,[Ze,l("div",$e,[el,l("div",ll,[l("span",sl,b(((o=e.tmp_user.parent)==null?void 0:o.sellout_code)||"-"),1),l("span",ol,b(((p=e.tmp_user.parent)==null?void 0:p.company_name)||"-"),1),l("span",tl,b(((d=e.tmp_user.parent)==null?void 0:d.email)||"-"),1),l("span",al,b(((A=e.tmp_user.parent)==null?void 0:A.role)||"-"),1)])])])):U("",!0)])]}),_:1})])}const cl=$(le,[["render",nl]]);export{cl as default};
