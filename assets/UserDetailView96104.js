import{e as H,u as J,r as K}from"./usetoast.esm96104.js";import{r as u,k as Q,c as v,n as W,_ as X,a as c,i as Z,o as h,b as C,e as l,f as t,q as g,w as $,g as ee,h as A,j as E,t as B}from"./_plugin-vue_export-helper96104.js";import{e as b,a as y,s as L,h as m}from"./helpers96104.js";import{u as le}from"./user96104.js";const oe={setup(){const T=u({icon:"pi pi-home",to:"/users"}),o=u(""),V=u([{label:""}]),e=u({}),F=u(),U=u(!1),D=Q(),i=H(),r=le(),x=J(),n=u(!1),p=u(!1),S=u(!1),f=u(!1),_=v(()=>r.getCurrentUser),s=v(()=>r.userRoles),N=v(()=>r.allUsers),j=v(()=>x.getUserCountryId),z=v(()=>x.getSelectedCountry),k=async function(a){L(),r.fetchUserDetail(a).then(()=>{m(),O()}).catch(d=>{m(),b(i,d)})},R=async function(a){const d=new Map;a&&d.set("full_name_or_email",a.query),d.set("country_id",j.value),e.value.role=="user"?d.set("role","agent"):e.value.role=="agent"?d.set("role","dealer"):e.value.role=="dealer"&&d.set("role","vendor"),await r.fetchAllUsers(d).catch(G=>{b(i,G)})},I=async function(){e.value.parent&&(e.value.parent_id=e.value.parent.id);const a={user:e.value};r.updateUser(a).then(()=>{m(),k(_.value.id+""),y(i,{message:"User updated correctly.",title:""})}).catch(d=>{m(),b(i,d)})},M=async function(){const a={user:e.value};r.createUser(a).then(()=>{m(),k(_.value.id+""),y(i,{message:"User created correctly.",title:""}),K.push({name:"user-detail",params:{id:_.value.id}})}).catch(d=>{m(),b(i,d)})},O=function(){var a;e.value=Object.assign({},_.value),e.value.country_id=(a=_.value.country)==null?void 0:a.id},q=function(){w(e.value.role),w(e.value.sellout_code),w(e.value.company_name)},P=function(){if(U.value=!0,q(),e.value.parent&&(e.value.parent_id=e.value.parent.id),f.value){y(i,{message:"Check that you have completed the required fields.",title:"",error:!0});return}o.value!=""||e.value.id?I():M(),U.value=!1,L()},w=function(a){if(U.value)return a==""||a==null?f.value=!0:f.value=!1,f.value},Y=async function(){r.disableUser(e.value.id+"",e.value.enabled).then(()=>{m(),e.value.enabled?y(i,{message:"User successfully enabled.",title:""}):y(i,{message:"User successfully disabled.",title:""})}).catch(a=>{m(),b(i,a)})};return W(async()=>{R(null),o.value=D.params.id+"",o.value!=""&&o.value!="undefined"?(k(o.value),V.value[0]={label:"Edit user"}):(V.value[0]={label:"New user"},e.value.country_id=z.value.id)}),{home:T,items:V,tmp_user:e,invalid_cluster:n,invalid_original_sellout_code:p,invalid_phone:S,userAdminRoles:s,filteredUsers:F,allUsers:N,saveUser:P,validateField:w,fetchAllUsers:R,disableUser:Y}},components:{}};const se={class:"m-4"},te={class:"flex justify-content-between align-items-center mb-3"},ae={class:"flex align-items-center justify-content-between"},ne=l("h2",{class:"mb-2"},"USER DETAILS",-1),ie={class:"formgrid grid col-10 px-0"},de={class:"field col-6"},re=l("label",{for:"cluster"},"Cluster*",-1),ue={key:0,class:"p-error"},ce={class:"field col-6"},me=l("label",{for:"name"},"Full name",-1),_e={class:"field col-6"},pe=l("label",{for:"phone"},"Phone",-1),fe={class:"field col-6"},ve=l("label",{for:"name"},"Email",-1),he={class:"field col-6"},ge=l("label",{for:"company"},"Company*",-1),be={key:0,class:"p-error"},ye={class:"field col-6"},Ve=l("label",{for:"name"},"Vat code",-1),Ue=l("div",{class:"flex align-items-center justify-content-between"},[l("h2",{class:"mb-2"},"SELLOUT DATA")],-1),xe={class:"formgrid grid col-10 px-0"},we={class:"field col-6"},Ce=l("label",{for:"sellout_code"},"Actual sellout code*",-1),Ae={key:0,class:"p-error"},De={class:"field col-6 flex flex-column"},Se=l("label",{for:"original_sellout_code"},"Original sellout code",-1),ke=l("div",{class:"flex align-items-center justify-content-between"},[l("h2",{class:"mb-2"},"DELIVERY ADDRESS")],-1),Ee={class:"formgrid grid col-10 px-0"},Te={class:"field col-6"},Fe=l("label",{for:"shipping_name"},"Recipient",-1),Re=l("div",{class:"col-6"},null,-1),Be={class:"field col-6"},Le=l("label",{for:"shipping_city"},"City",-1),Ne={class:"field col-3"},je=l("label",{for:"shipping_province"},"Province",-1),ze={class:"field col-2"},Ie=l("label",{for:"shipping_zip"},"Cap",-1),Me={class:"field col-6"},Oe=l("label",{for:"shipping_zip"},"Address",-1),qe={class:"field col-3"},Pe=l("label",{for:"shipping_number"},"Number",-1),Ye={class:"field col-12"},Ge=l("label",{for:"shipping_note"},"Note",-1),He=l("div",{class:"flex align-items-center justify-content-between"},[l("h2",{class:"mb-2"},"MORE DATA")],-1),Je={class:"formgrid grid col-10 px-0"},Ke={class:"field col-6 flex flex-column"},Qe=l("label",{for:"original_sellout_code"},"User father",-1);function We(T,o,V,e,F,U){const D=c("Breadcrumb"),i=c("Button"),r=c("InputSwitch"),x=c("Dropdown"),n=c("InputText"),p=c("Card"),S=c("Textarea"),f=c("AutoComplete"),_=Z("tooltip");return h(),C("div",se,[l("div",te,[t(D,{home:e.home,model:e.items,class:"mt-0 p-0"},null,8,["home","model"]),t(i,{label:"Save",onClick:e.saveUser},null,8,["onClick"])]),t(p,null,{content:g(()=>[l("div",ae,[ne,e.tmp_user.id?$((h(),ee(r,{key:0,modelValue:e.tmp_user.enabled,"onUpdate:modelValue":o[0]||(o[0]=s=>e.tmp_user.enabled=s),onChange:o[1]||(o[1]=s=>e.disableUser())},null,8,["modelValue"])),[[_,e.tmp_user.enabled?"Enabled":"Disabled",void 0,{top:!0}]]):A("",!0)]),l("div",ie,[l("div",de,[re,t(x,{modelValue:e.tmp_user.role,"onUpdate:modelValue":o[2]||(o[2]=s=>e.tmp_user.role=s),options:e.userAdminRoles,optionLabel:"name",optionValue:"value",id:"cluster",class:E(["w-full",{"p-invalid":e.validateField(e.tmp_user.role)}])},null,8,["modelValue","options","class"]),e.validateField(e.tmp_user.role)?(h(),C("small",ue,"Campo obbligatorio.")):A("",!0)]),l("div",ce,[me,t(n,{id:"name",type:"text",modelValue:e.tmp_user.full_name,"onUpdate:modelValue":o[3]||(o[3]=s=>e.tmp_user.full_name=s),class:"w-full"},null,8,["modelValue"])]),l("div",_e,[pe,t(n,{id:"phone",type:"text",modelValue:e.tmp_user.phone,"onUpdate:modelValue":o[4]||(o[4]=s=>e.tmp_user.phone=s),class:"w-full"},null,8,["modelValue"])]),l("div",fe,[ve,t(n,{id:"name",type:"text",modelValue:e.tmp_user.email,"onUpdate:modelValue":o[5]||(o[5]=s=>e.tmp_user.email=s),class:"w-full"},null,8,["modelValue"])]),l("div",he,[ge,t(n,{id:"company_name",type:"text",modelValue:e.tmp_user.company_name,"onUpdate:modelValue":o[6]||(o[6]=s=>e.tmp_user.company_name=s),class:E(["w-full",{"p-invalid":e.validateField(e.tmp_user.company_name)}])},null,8,["modelValue","class"]),e.validateField(e.tmp_user.company_name)?(h(),C("small",be,"Campo obbligatorio.")):A("",!0)]),l("div",ye,[Ve,t(n,{id:"name",type:"text",modelValue:e.tmp_user.vat_cf,"onUpdate:modelValue":o[7]||(o[7]=s=>e.tmp_user.vat_cf=s),class:"w-full"},null,8,["modelValue"])])])]),_:1}),t(p,{class:"mt-4"},{content:g(()=>[Ue,l("div",xe,[l("div",we,[Ce,t(n,{id:"sellout_code",type:"text",modelValue:e.tmp_user.sellout_code,"onUpdate:modelValue":o[8]||(o[8]=s=>e.tmp_user.sellout_code=s),class:E(["w-full",{"p-invalid":e.validateField(e.tmp_user.original_sellout_code)}])},null,8,["modelValue","class"]),e.validateField(e.tmp_user.sellout_code)?(h(),C("small",Ae,"Campo obbligatorio.")):A("",!0)]),l("div",De,[Se,t(n,{id:"original_sellout_code",type:"text",modelValue:e.tmp_user.original_sellout_code,"onUpdate:modelValue":o[9]||(o[9]=s=>e.tmp_user.original_sellout_code=s)},null,8,["modelValue"])])])]),_:1}),t(p,{class:"mt-4"},{content:g(()=>[ke,l("div",Ee,[l("div",Te,[Fe,t(n,{id:"shipping_name",type:"text",modelValue:e.tmp_user.shipping_name,"onUpdate:modelValue":o[10]||(o[10]=s=>e.tmp_user.shipping_name=s),class:"w-full"},null,8,["modelValue"])]),Re,l("div",Be,[Le,t(n,{id:"shipping_city",type:"text",modelValue:e.tmp_user.shipping_city,"onUpdate:modelValue":o[11]||(o[11]=s=>e.tmp_user.shipping_city=s),class:"w-full"},null,8,["modelValue"])]),l("div",Ne,[je,t(n,{id:"shipping_province",type:"text",modelValue:e.tmp_user.shipping_province,"onUpdate:modelValue":o[12]||(o[12]=s=>e.tmp_user.shipping_province=s),class:"w-full"},null,8,["modelValue"])]),l("div",ze,[Ie,t(n,{id:"shipping_zip",type:"text",modelValue:e.tmp_user.shipping_zip,"onUpdate:modelValue":o[13]||(o[13]=s=>e.tmp_user.shipping_zip=s),class:"w-full"},null,8,["modelValue"])]),l("div",Me,[Oe,t(n,{id:"shipping_zip",type:"text",modelValue:e.tmp_user.shipping_address,"onUpdate:modelValue":o[14]||(o[14]=s=>e.tmp_user.shipping_address=s),class:"w-full"},null,8,["modelValue"])]),l("div",qe,[Pe,t(n,{id:"shipping_number",type:"text",modelValue:e.tmp_user.shipping_number,"onUpdate:modelValue":o[15]||(o[15]=s=>e.tmp_user.shipping_number=s),class:"w-full"},null,8,["modelValue"])]),l("div",Ye,[Ge,t(S,{modelValue:e.tmp_user.shipping_note,"onUpdate:modelValue":o[16]||(o[16]=s=>e.tmp_user.shipping_note=s),rows:"5",cols:"30",class:"w-full"},null,8,["modelValue"])])])]),_:1}),t(p,{class:"mt-4"},{content:g(()=>[He,l("div",Je,[l("div",Ke,[Qe,t(f,{modelValue:e.tmp_user.parent,"onUpdate:modelValue":o[17]||(o[17]=s=>e.tmp_user.parent=s),suggestions:e.allUsers,onComplete:o[18]||(o[18]=s=>e.fetchAllUsers(s)),optionLabel:"email",optionValude:"id",emptySearchMessage:"Nessun risultato",emptySelectionMessage:"Nessun risultato",disabled:!e.tmp_user.role,placeholder:"Search by full name or email"},{item:g(s=>[l("div",null,B(s.item.full_name)+" ("+B(s.item.email)+") ",1)]),_:1},8,["modelValue","suggestions","disabled"])])])]),_:1})])}const ll=X(oe,[["render",We]]);export{ll as default};
