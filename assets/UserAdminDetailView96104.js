import{e as j,u as L}from"./usetoast.esm96104.js";import{r as u,k as N,c as b,n as q,_ as z,a as d,i as O,o as g,b as A,e as a,f as m,q as G,w as H,g as J,h as D,j as K}from"./_plugin-vue_export-helper96104.js";import{a as v,s as S,h as r,e as U}from"./helpers96104.js";import{u as M}from"./user96104.js";import{u as P}from"./country96104.js";const Q={setup(){const w=u({icon:"pi pi-home",to:"/users-admin"}),t=u(""),p=u([{label:""}]),e=u({}),x=u(),f=u(!1),y=N(),o=j(),n=M();P();const h=L(),i=u(!1),c=b(()=>n.getCurrentUser),C=b(()=>n.userAdminRoles);b(()=>h.getUserCountryId);const l=b(()=>h.getSelectedCountry),V=async function(s){S(),n.fetchUserDetail(s).then(()=>{r(),F()}).catch(_=>{r(),U(o,_)})},B=async function(){e.value.parent&&(e.value.parent_id=e.value.parent.id);const s={user:e.value};n.updateUserAdmin(s).then(()=>{r(),V(c.value.id+""),v(o,{message:"User updated correctly.",title:""})}).catch(_=>{r(),U(o,_)})},E=async function(){const s={user:e.value};n.createUserAdmin(s).then(()=>{r(),V(c.value.id+""),v(o,{message:"User created correctly.",title:""})}).catch(_=>{r(),U(o,_)})},F=function(){var s;e.value=Object.assign({},c.value),e.value.country_id=(s=c.value.country)==null?void 0:s.id},I=function(){k(e.value.role)},T=function(){if(f.value=!0,I(),i.value){v(o,{message:"Check that you have completed the required fields.",title:"",error:!0});return}t.value!=""&&e.value.id?B():E(),f.value=!1,S()},k=function(s){if(f.value)return s==""||s==null?i.value=!0:i.value=!1,i.value},R=async function(){n.disableUserAdmin(e.value.id+"",e.value.enabled).then(()=>{r(),e.value.enabled?v(o,{message:"User successfully enabled.",title:""}):v(o,{message:"User successfully disabled.",title:""})}).catch(s=>{r(),U(o,s)})};return q(async()=>{t.value=y.params.id+"",t.value!=""&&t.value!="undefined"?(V(t.value),p.value[0]={label:"Edit user"}):(p.value[0]={label:"New user"},e.value.country_id=l.value.id)}),{home:w,items:p,tmp_user:e,userAdminRoles:C,filteredUsers:x,saveUser:T,validateField:k,disableUser:R}},components:{}};const W={class:"m-4"},X={class:"flex justify-content-between align-items-center mb-3"},Y={class:"flex align-items-center justify-content-between"},Z=a("h2",{class:"mb-2"},"USER DETAILS",-1),$={class:"formgrid grid col-10 px-0"},ee={class:"field col-6"},te=a("label",{for:"cluster"},"Cluster*",-1),se={key:0,class:"p-error"},oe={class:"field col-6"},le=a("label",{for:"name"},"Full name",-1),ae={class:"field col-6"},ne=a("label",{for:"name"},"Email",-1);function re(w,t,p,e,x,f){const y=d("Breadcrumb"),o=d("Button"),n=d("InputSwitch"),h=d("Dropdown"),i=d("InputText"),c=d("Card"),C=O("tooltip");return g(),A("div",W,[a("div",X,[m(y,{home:e.home,model:e.items,class:"mt-0 p-0"},null,8,["home","model"]),m(o,{label:"Save",onClick:e.saveUser},null,8,["onClick"])]),m(c,null,{content:G(()=>[a("div",Y,[Z,e.tmp_user.id?H((g(),J(n,{key:0,modelValue:e.tmp_user.enabled,"onUpdate:modelValue":t[0]||(t[0]=l=>e.tmp_user.enabled=l),onChange:t[1]||(t[1]=l=>e.disableUser())},null,8,["modelValue"])),[[C,e.tmp_user.enabled?"Enabled":"Disabled",void 0,{top:!0}]]):D("",!0)]),a("div",$,[a("div",ee,[te,m(h,{modelValue:e.tmp_user.role,"onUpdate:modelValue":t[2]||(t[2]=l=>e.tmp_user.role=l),options:e.userAdminRoles,optionLabel:"name",optionValue:"value",id:"cluster",class:K(["w-full",{"p-invalid":e.validateField(e.tmp_user.role)}])},null,8,["modelValue","options","class"]),e.validateField(e.tmp_user.role)?(g(),A("small",se,"Campo obbligatorio.")):D("",!0)]),a("div",oe,[le,m(i,{id:"name",type:"text",modelValue:e.tmp_user.full_name,"onUpdate:modelValue":t[3]||(t[3]=l=>e.tmp_user.full_name=l),class:"w-full"},null,8,["modelValue"])]),a("div",ae,[ne,m(i,{id:"name",type:"text",modelValue:e.tmp_user.email,"onUpdate:modelValue":t[4]||(t[4]=l=>e.tmp_user.email=l),class:"w-full"},null,8,["modelValue"])])])]),_:1})])}const _e=z(Q,[["render",re]]);export{_e as default};
