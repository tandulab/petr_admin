import{d as j,ab as A,u as U,ac as M,r as _,s as N,c as T,a as g,_ as I,b as i,o as w,e as h,g as r,v,f as t,l as y,x as V,i as C,B as z}from"./usetoast.esm40966.js";import{u as E,r as P,e as q}from"./index.esm40966.js";import{s as D,h as L,e as $}from"./helpers40966.js";import{u as F,L as R}from"./sidebar40966.js";import{u as W}from"./country40966.js";import{u as G}from"./product40966.js";import{a as H}from"./runtime-dom.esm-bundler40966.js";const J=j({name:"LoginView",setup(){A(()=>{c.setSidebarVisibility(!1)});const e=U(),s=M(),c=F(),b=W(),S=_(1),m=N({email:"",password:"",terms:null}),u={password:{required:P},email:{required:P,email:q}},n=_(!1),p=E(u,m),d=T(()=>e.user),f=G(),o=a=>{n.value=!0,a&&(D(),k().then(()=>{L(),d.value.force_change_password&&g.push({name:"reset-password"}),c.setSidebarVisibility(!0),x(),B(),g.push({name:"users"})}).catch(l=>{L(),$(s,l)}))};async function k(){const a={login:m.email,password:m.password};await e.login(a)}const x=async function(){const a=new Map;await b.fetchAllCountries(a).catch(l=>{$(s,l)})},B=async function(){const a=new Map;await f.fetchAllProducts(a).catch(l=>{$(s,l)})};return{formStep:S,formSubmitted:n,v$:p,currentUser:d,handleSubmit:o}},components:{LogoPetronas:R}}),K={class:"flex justify-content-center align-items-center h-screen"},O={class:"mt-5 text-center"},Q=t("h1",{class:"text-center mb-2"},"Sign In!",-1),X=t("h2",{class:"font-normal mb-4"}," Welcome! Please enter your email and password. ",-1),Y={key:0,class:"p-error w-100"},Z={class:"w-full flex flex-column flex-1"},ee={class:"flex justify-content-between mt-1"},se={key:0,class:"p-error col-5 p-0 m-0"},oe={class:"w-full flex justify-content-end text-sm cursor-pointer text-color-secondary"},te={class:"mt-2 text-right w-full mb-3"};function ae(e,s,c,b,S,m){const u=i("LogoPetronas"),n=i("InputText"),p=i("router-link"),d=i("Button"),f=i("Card");return w(),h("div",K,[r(f,{class:"p-4"},{header:v(()=>[t("div",O,[r(u)])]),content:v(()=>[Q,X,t("form",{class:"mt-4 flex flex-column",onSubmit:s[2]||(s[2]=H(o=>e.handleSubmit(!e.v$.$invalid),["prevent"]))},[r(n,{id:"email",class:y({"p-invalid":e.v$.email.$invalid&&e.formSubmitted,"w-100":!0,"mb-1":!0}),placeholder:"Email*",modelValue:e.v$.email.$model,"onUpdate:modelValue":s[0]||(s[0]=o=>e.v$.email.$model=o)},null,8,["class","modelValue"]),e.formSubmitted&&e.v$.email.$errors.length>0?(w(),h("label",Y,V(e.v$.email.$errors.map(o=>o.$message).join("<br />")),1)):C("",!0),t("div",Z,[r(n,{id:"password",class:y({"p-invalid":e.v$.password.$invalid&&e.formSubmitted,"w-100":!0,"mt-3":!0,"mb-1":!0}),type:"password",placeholder:"Password*",modelValue:e.v$.password.$model,"onUpdate:modelValue":s[1]||(s[1]=o=>e.v$.password.$model=o)},null,8,["class","modelValue"]),t("div",ee,[e.formSubmitted&&e.v$.password.$errors.length>0?(w(),h("label",se,V(e.v$.password.$errors.map(o=>o.$message).join("<br />")),1)):C("",!0),t("div",oe,[r(p,{to:"/forgot-password",class:"text-color-secondary"},{default:v(()=>[z("Forgot Password?")]),_:1})])])]),t("div",te,[r(d,{type:"submit",label:"Sign in",class:"w-full mt-4 capitalize"})])],32)]),_:1})])}const ue=I(J,[["render",ae]]);export{ue as default};
